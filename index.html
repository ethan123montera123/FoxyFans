<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Application Form</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-r from-pink-500 to-white min-h-screen flex justify-center items-center">

    <!-- Container for form with shadow and rounded corners -->
    <div class="bg-white p-12 rounded-lg shadow-2xl w-full max-w-3xl transform transition-all duration-500 hover:scale-105 mt-16 mb-16">
        <h1 class="text-4xl font-semibold text-center text-gray-800 mb-8">Join Our Team!</h1>

        <form id="applicationForm" class="space-y-6">
            <!-- Name Input -->
            <div>
                <label for="name" class="block text-sm font-medium text-gray-700">Full Name</label>
                <input type="text" id="name" name="name" required class="mt-2 block w-full p-3 rounded-lg border-2 border-gray-300 focus:ring-2 focus:ring-blue-500">
            </div>
            
            <!-- Location Input -->
            <div>
                <label for="location" class="block text-sm font-medium text-gray-700">Location</label>
                <input type="text" id="location" name="location" required class="mt-2 block w-full p-3 rounded-lg border-2 border-gray-300 focus:ring-2 focus:ring-blue-500">
            </div>
            
            <!-- Age Input -->
            <div>
                <label for="age" class="block text-sm font-medium text-gray-700">Age</label>
                <input type="number" id="age" name="age" required class="mt-2 block w-full p-3 rounded-lg border-2 border-gray-300 focus:ring-2 focus:ring-blue-500">
            </div>

            <!-- Work Experience Textarea -->
            <div>
                <label for="workExperience" class="block text-sm font-medium text-gray-700">Work Experience</label>
                <textarea id="workExperience" name="workExperience" required class="mt-2 block w-full p-3 rounded-lg border-2 border-gray-300 focus:ring-2 focus:ring-blue-500"></textarea>
            </div>

            <!-- Last Job Performance Input -->
            <div>
                <label for="lastJobPerformance" class="block text-sm font-medium text-gray-700">Last Job's Performance</label>
                <input type="text" id="lastJobPerformance" name="lastJobPerformance" required class="mt-2 block w-full p-3 rounded-lg border-2 border-gray-300 focus:ring-2 focus:ring-blue-500">
            </div>

            <!-- Work Issues Textarea -->
            <div>
                <label for="workIssues" class="block text-sm font-medium text-gray-700">Work Issues (WiFi, Motivation, etc.)</label>
                <textarea id="workIssues" name="workIssues" required class="mt-2 block w-full p-3 rounded-lg border-2 border-gray-300 focus:ring-2 focus:ring-blue-500"></textarea>
            </div>

            <!-- Typing Test File Upload -->
            <div>
                <label for="typingTest" class="block text-sm font-medium text-gray-700">Typing Test (55 WPM minimum)</label>
                <input type="file" id="typingTest" name="typingTest" required class="mt-2 block w-full p-3 rounded-lg border-2 border-gray-300 focus:ring-2 focus:ring-blue-500">
            </div>

            <!-- Proof of Logouts File Upload -->
            <div>
                <label for="proofOfLogouts" class="block text-sm font-medium text-gray-700">Proof of Logout Reports (only if >$700)</label>
                <input type="file" id="proofOfLogouts" name="proofOfLogouts" class="mt-2 block w-full p-3 rounded-lg border-2 border-gray-300 focus:ring-2 focus:ring-blue-500">
            </div>

            <!-- Telegram Username Input -->
            <div>
                <label for="telegramUsername" class="block text-sm font-medium text-gray-700">Telegram Username</label>
                <input type="text" id="telegramUsername" name="telegramUsername" required class="mt-2 block w-full p-3 rounded-lg border-2 border-gray-300 focus:ring-2 focus:ring-blue-500">
            </div>

            <!-- Status Message -->
            <div id="statusMessage" class="text-center text-sm text-blue-500 hidden">Processing...</div>

            <!-- Submit Button -->
            <button type="submit" class="w-full bg-pink-600 text-white py-3 px-6 rounded-lg hover:bg-blue-700 transition duration-200">Submit</button>
        </form>
    </div>

    <script type="module">
        // Import Firebase dependencies
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
        import { getDatabase, ref, push, set } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js";

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBQv0xhSZS0Sv--8ohXsrtME_HLlVTOeLg",
            authDomain: "foxyfans-e9761.firebaseapp.com",
            databaseURL: "https://foxyfans-e9761-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "foxyfans-e9761",
            storageBucket: "foxyfans-e9761.firebasestorage.app",
            messagingSenderId: "509215295074",
            appId: "1:509215295074:web:2bb6485985db4b99e2333b"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // Handle form submission
        const form = document.getElementById('applicationForm');
        const statusMessage = document.getElementById('statusMessage');
        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            // Show processing status
            statusMessage.classList.remove('hidden');

            const name = form.name.value;
            const location = form.location.value;
            const age = form.age.value;
            const workExperience = form.workExperience.value;
            const lastJobPerformance = form.lastJobPerformance.value;
            const workIssues = form.workIssues.value;
            const typingTest = form.typingTest.files[0];
            const proofOfLogouts = form.proofOfLogouts.files[0];
            const telegramUsername = form.telegramUsername.value;

            try {
                const newEntryRef = push(ref(database, 'applications'));
                await set(newEntryRef, {
                    name,
                    location,
                    age,
                    workExperience,
                    lastJobPerformance,
                    workIssues,
                    typingTest: typingTest.name,
                    proofOfLogouts: proofOfLogouts ? proofOfLogouts.name : null,
                    telegramUsername,
                    status: 'Processing'  // Automatically set the status to "Processing"
                });
                alert('Application submitted successfully!');
                form.reset();
                statusMessage.classList.add('hidden');  // Hide processing status once submission is complete
            } catch (error) {
                console.error('Error submitting application:', error);
                alert('Failed to submit application. Please try again later.');
                statusMessage.classList.add('hidden');  // Hide processing status on error
            }
        });
    </script>

</body>
</html>
